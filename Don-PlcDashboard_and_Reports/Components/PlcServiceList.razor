@inject PlcService plcService
@inject RaportareDbContext context
<h3>PlcServiceList</h3>


    <h1>Index</h1>

    <p>
        <button class="btn btn-primary" @onclick="CretePlcList">Create Plc List</button>
        <button class="btn btn-danger" @onclick="(() => plcService.ListPlcs.Clear())">Clear Plc List</button>
    </p>
    <table class="table">
        <thead>
            <tr>
                <th></th>
                <th>
                    Nume
                </th>
                <th>
                    Ip
                </th>
                <th>
                    IsConnected
                </th>
                <th>
                    <button class="btn btn-primary" @onclick="ConnectAllPlcs">Connect All</button>
                </th>
                <th>
                    <button class="btn btn-danger" @onclick="DisconnectAllPlcs">Disconnect All</button>
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (var plc in plcServiceList)
            {
            <tr>
                <td>
                    <a>Tags List</a>
                </td>
                <td>
                    @plc.Name
                </td>
                <td>
                    @plc.Ip
                </td>
                <td>
                    @plc.PlcObject.IsConnected
                </td>
                <td>
                    <button class="btn btn-outline-primary" @onclick="(() => plcService.ConnectPlc(plc.PlcObject))">Connect Plc</button>
                </td>
                <td>
                    <button class="btn btn-outline-danger" @onclick="(() => plcService.DisconnectPlc(plc.PlcObject))">Disconnect Plc</button>
                </td>
            </tr>
            }
        </tbody>
    </table>







    @code {
        public List<PlcModel> plcServiceList;
        // Initialize List of Plc from DbContext Plc
        protected override void OnInitialized()
        {
            plcServiceList = plcService.ListPlcs;
        }
        // Click event create plc list
        private async Task CretePlcList()
        {
            await plcService.InitializeListOfPlcAsync(context);
        }

        // Click event Connect all Plcs
        private void ConnectAllPlcs()
        {
            foreach (var plc in plcService.ListPlcs)
            {
                plcService.ConnectPlc(plc.PlcObject);
            }
        }
        // Click event Disconnect all Plcs
        private void DisconnectAllPlcs()
        {
            foreach (var plc in plcService.ListPlcs)
            {
                plcService.DisconnectPlc(plc.PlcObject);
            }
        }
    }
